<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>מרכז שירות ברע״מ | VAG Specialist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700;800&display=swap');
        body { font-family: 'Assistant', sans-serif; background-color: #f8fafc; overflow-x: hidden; }
        
        .hero-bg { 
            background: linear-gradient(135deg, #0f172a 0%, #1e40af 100%); 
            color: white; padding: 40px 20px 100px 20px; text-align: center; 
            clip-path: ellipse(150% 100% at 50% 0%); position: relative; z-index: 1;
        }

        .services-container { position: relative; z-index: 10; margin-top: -60px; padding: 0 15px; }
        .service-card { background: white; border-radius: 20px; padding: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.06); border: 1px solid #f1f5f9; text-align: center; transition: transform 0.2s; }
        .service-card:active { transform: scale(0.95); }

        .action-box { 
            background: #ffffff; border-radius: 25px; padding: 18px; margin: 12px 0; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; 
            width: 100%; text-align: right;
        }
        
        .tip-box {
            background: linear-gradient(to left, #fffcf0, #fff);
            border-right: 4px solid #fbbf24;
            border-radius: 15px; padding: 15px; margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.1);
        }

        .side-menu { position: fixed; top: 0; right: -280px; width: 280px; height: 100%; background: #0f172a; z-index: 1000; transition: 0.4s; padding: 40px 20px; color: white; }
        .side-menu.active { right: 0; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; z-index: 999; }
        
        .hidden { display: none !important; }

        input, textarea, select { border: 1px solid #e2e8f0 !important; }
        input:focus { border-color: #3b82f6 !important; ring: 2px #3b82f6; }
    </style>
</head>
<body>

    <div id="overlay" class="overlay" onclick="toggleMenu()"></div>
    <div id="sideMenu" class="side-menu text-right">
        <div class="flex justify-between items-center mb-10">
            <h3 class="text-xl font-bold border-b border-gray-700 pb-2">תפריט ברע״מ</h3>
            <button onclick="toggleMenu()"><i class="fas fa-times text-xl text-gray-400"></i></button>
        </div>
        <ul class="space-y-6">
            <li><a href="#" onclick="showPage('home')" class="block text-lg"><i class="fas fa-home ml-3 text-blue-400"></i>דף הבית</a></li>
            <li><a href="#" onclick="showPage('crm')" class="block text-lg font-bold"><i class="fas fa-calendar-alt ml-3 text-blue-400"></i>תיאום תור</a></li>
            <li><a href="tel:086277195" class="block text-lg"><i class="fas fa-phone ml-3 text-green-400"></i>חיוג למוסך</a></li>
            <li><a href="https://wa.me/972505858750" class="block text-lg"><i class="fab fa-whatsapp ml-3 text-green-500"></i>וואטסאפ מנהל</a></li>
        </ul>
    </div>

    <header class="p-4 bg-white sticky top-0 z-[100] border-b shadow-sm">
        <div class="flex justify-between items-center max-w-lg mx-auto">
            <button onclick="toggleMenu()" class="text-2xl text-slate-700 w-10 h-10 flex items-center justify-center bg-gray-50 rounded-xl"><i class="fas fa-bars"></i></button>
            <div class="text-center">
                <h1 class="font-extrabold text-blue-900 text-lg leading-tight tracking-tighter">מרכז שירות ברע״מ</h1>
                <p id="liveDateTime" class="text-[10px] font-bold text-blue-600 mt-0.5 uppercase tracking-widest"></p>
            </div>
            <div class="w-10"></div>
        </div>
    </header>

    <div id="homePage">
        <section class="hero-bg">
            <div class="max-w-md mx-auto">
                <h2 class="text-3xl font-black mb-2 italic">מומחי VAG</h2>
                <p class="text-blue-100 text-sm opacity-90 font-medium">Professional Care for Audi, VW, Skoda, Seat</p>
                <div class="mt-4 inline-flex items-center gap-2 bg-white/10 px-4 py-1.5 rounded-full border border-white/20 text-[11px] font-bold">
                    <span class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span>
                    מרכז שירות פעיל כעת
                </div>
            </div>
        </section>

        <div class="services-container max-w-lg mx-auto">
            <div class="grid grid-cols-2 gap-3 mb-6">
                <div class="service-card"><i class="fas fa-laptop-code text-blue-600 text-2xl mb-2 block"></i><h4 class="font-bold text-[11px]">דיאגנוסטיקה</h4></div>
                <div class="service-card"><i class="fas fa-oil-can text-blue-600 text-2xl mb-2 block"></i><h4 class="font-bold text-[11px]">טיפול תקופתי</h4></div>
                <div class="service-card"><i class="fas fa-cogs text-blue-600 text-2xl mb-2 block"></i><h4 class="font-bold text-[11px]">שיפוץ גירים</h4></div>
                <div class="service-card"><i class="fas fa-snowflake text-blue-600 text-2xl mb-2 block"></i><h4 class="font-bold text-[11px]">חשמל ומיזוג</h4></div>
            </div>

            <div class="tip-box flex items-start gap-4">
                <div class="bg-yellow-100 p-2 rounded-lg">
                    <i class="fas fa-lightbulb text-yellow-600 text-lg"></i>
                </div>
                <div>
                    <h5 class="font-bold text-xs text-yellow-800 uppercase">טיפול מונע: טיפ יומי</h5>
                    <p id="dailyTipText" class="text-[11px] text-gray-600 mt-1 leading-relaxed font-medium"></p>
                </div>
            </div>

            <button onclick="showPage('crm')" class="action-box group active:bg-gray-50 transition-colors">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-blue-50 rounded-2xl flex items-center justify-center text-blue-900 text-xl group-hover:bg-blue-100 transition-colors">
                        <i class="fas fa-calendar-plus"></i>
                    </div>
                    <div class="flex-1">
                        <h3 class="font-bold text-gray-800 text-sm">תיאום תור למוסך</h3>
                        <p class="text-[10px] text-gray-400 font-medium">שריין לעצמך מקום בלו"ז הטיפולים</p>
                    </div>
                    <i class="fas fa-chevron-left text-gray-300 text-sm ml-2"></i>
                </div>
            </button>

            <div class="action-box">
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-12 h-12 bg-slate-900 rounded-2xl flex items-center justify-center text-white text-xl">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-gray-800 text-sm">המומחה הוירטואלי (AI)</h3>
                        <p class="text-[9px] text-blue-600 font-bold uppercase">VAG Expert Analysis</p>
                    </div>
                </div>
                <div id="expertRes" class="hidden p-4 bg-blue-50 border-r-4 border-blue-900 text-[11px] text-blue-900 mb-4 rounded-xl leading-relaxed"></div>
                <div class="relative">
                    <input type="text" id="expertInput" placeholder="תאר את התקלה (למשל: נורת מנוע דולקת)..." class="w-full p-4 bg-gray-50 border border-gray-100 rounded-2xl text-xs outline-none focus:bg-white transition-all">
                    <button onclick="askExpert()" class="absolute left-2 top-2 bg-blue-900 text-white w-9 h-9 rounded-xl flex items-center justify-center shadow-lg active:scale-90 transition-transform">
                        <i class="fas fa-paper-plane text-xs"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="px-6 mt-6 mb-12 max-w-lg mx-auto">
            <a href="https://wa.me/972505858750" class="w-full bg-green-500 text-white rounded-[25px] p-5 flex items-center justify-center gap-3 shadow-xl font-bold text-sm active:scale-95 transition-transform">
                <i class="fab fa-whatsapp text-2xl"></i>
                שלח הודעה דחופה לוואטסאפ
            </a>
        </div>
    </div>

    <div id="crmPage" class="hidden min-h-screen p-6 bg-white overflow-y-auto">
        <div class="max-w-lg mx-auto">
            <button onclick="showPage('home')" class="mb-8 flex items-center gap-2 text-blue-600 font-extrabold text-sm bg-blue-50 px-5 py-3 rounded-2xl border border-blue-100 active:bg-blue-100 transition-colors">
                <i class="fas fa-arrow-right"></i>
                חזרה לדף הבית
            </button>

            <div class="mb-8">
                <h3 class="text-3xl font-black text-blue-900 mb-2 italic">קביעת תור</h3>
                <p class="text-gray-400 text-xs font-bold uppercase tracking-wider">Appointment Booking System</p>
            </div>
            
            <div class="space-y-4">
                <div class="space-y-1">
                    <label class="text-[10px] font-bold text-gray-400 mr-2">מספר רכב</label>
                    <input type="text" id="appPlate" placeholder="00-000-00" class="w-full p-4 bg-gray-50 rounded-2xl font-black text-center text-xl tracking-[0.2em] outline-none">
                </div>
                
                <div class="grid grid-cols-2 gap-3">
                    <div class="space-y-1">
                        <label class="text-[10px] font-bold text-gray-400 mr-2">שם מלא</label>
                        <input type="text" id="appName" placeholder="ישראל ישראלי" class="w-full p-4 bg-gray-50 rounded-2xl font-bold text-sm outline-none">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-bold text-gray-400 mr-2">טלפון</label>
                        <input type="tel" id="appPhone" placeholder="050-0000000" class="w-full p-4 bg-gray-50 rounded-2xl font-bold text-sm outline-none">
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-3">
                    <div class="space-y-1">
                        <label class="text-[10px] font-bold text-gray-400 mr-2">תאריך מבוקש</label>
                        <input type="date" id="appDate" class="w-full p-4 bg-gray-50 rounded-2xl text-sm font-bold outline-none">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-bold text-gray-400 mr-2">שעה מועדפת</label>
                        <select id="appTime" class="w-full p-4 bg-gray-50 rounded-2xl text-sm font-bold outline-none appearance-none">
                            <option>07:30</option><option>08:30</option><option>09:30</option><option>10:30</option>
                            <option>11:30</option><option>12:30</option><option>13:30</option><option>14:30</option>
                        </select>
                    </div>
                </div>
                
                <div class="space-y-1">
                    <label class="text-[10px] font-bold text-gray-400 mr-2">סיבת ההגעה</label>
                    <textarea id="appReason" placeholder="תאר בקצרה מה דרוש לרכב..." class="w-full p-4 bg-gray-50 rounded-2xl h-28 text-sm font-medium outline-none resize-none"></textarea>
                </div>
                
                <button onclick="bookAppointment()" id="bookBtn" class="w-full bg-blue-900 text-white p-5 rounded-[25px] font-black shadow-2xl active:scale-95 transition-transform mt-4">
                    שלח בקשת תור <i class="fas fa-paper-plane mr-2"></i>
                </button>
                <p id="appMsg" class="hidden text-green-700 font-bold text-center mt-6 bg-green-50 p-4 rounded-2xl border border-green-100 animate-bounce">
                    <i class="fas fa-check-circle ml-2"></i> התור נשלח! ניצור איתך קשר לאישור.
                </p>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDD7YAdTePRWYjwBbmy3gLRYd_OLDwpTL8",
            authDomain: "baram-vag-45e12.firebaseapp.com",
            projectId: "baram-vag-45e12",
            storageBucket: "baram-vag-45e12.firebasestorage.app",
            messagingSenderId: "761383355945",
            appId: "1:761383355945:web:552554b5a6b9fe5e78be38"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // תאריך ושעה חיים
        function updateDateTime() {
            const now = new Date();
            const options = { weekday: 'long', day: 'numeric', month: 'long', hour: '2-digit', minute: '2-digit' };
            document.getElementById('liveDateTime').innerText = now.toLocaleDateString('he-IL', options);
        }
        setInterval(updateDateTime, 1000); updateDateTime();

        // טיפ יומי אקראי
        const tips = [
            "החלפת שמן גיר DSG בכל 60,000 ק\"מ שומרת על אורך חיי הגיר.",
            "בקיץ הישראלי, מומלץ לבדוק את גובה נוזל הקירור כשהמנוע קר.",
            "רעידות בבלימה? ייתכן והצלחות התעוותו. כדאי לבדוק בהקדם.",
            "נורת AdBlue דולקת? אל תמתין לרגע האחרון, הרכב עלול להינעל."
        ];
        document.getElementById('dailyTipText').innerText = tips[Math.floor(Math.random() * tips.length)];

        // ניווט דפים
        function toggleMenu() {
            const m = document.getElementById('sideMenu');
            const o = document.getElementById('overlay');
            m.classList.toggle('active');
            o.style.display = m.classList.contains('active') ? 'block' : 'none';
        }

        function showPage(p) {
            document.getElementById('homePage').classList.toggle('hidden', p !== 'home');
            document.getElementById('crmPage').classList.toggle('hidden', p !== 'crm');
            if(document.getElementById('sideMenu').classList.contains('active')) toggleMenu();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        // פונקציית תיאום תור
        async function bookAppointment() {
            const btn = document.getElementById('bookBtn');
            const msg = document.getElementById('appMsg');
            const data = {
                carPlate: document.getElementById('appPlate').value,
                customerName: document.getElementById('appName').value,
                phone: document.getElementById('appPhone').value,
                date: document.getElementById('appDate').value,
                time: document.getElementById('appTime').value,
                reason: document.getElementById('appReason').value,
                createdAt: new Date()
            };

            if(!data.carPlate || !data.customerName || !data.date) {
                alert("נא למלא מספר רכב, שם ותאריך");
                return;
            }

            btn.disabled = true;
            btn.innerHTML = "<i class='fas fa-circle-notch animate-spin'></i> שולח...";

            try {
                await db.collection("appointments").add(data);
                msg.classList.remove('hidden');
                btn.innerHTML = "התור נשלח בהצלחה!";
                setTimeout(() => showPage('home'), 3000);
            } catch (e) {
                alert("שגיאה בשליחה. בדוק חיבור אינטרנט.");
                btn.disabled = false;
                btn.innerHTML = "נסה שוב";
            }
        }

        // פונקציית AI (Gemini)
        async function askExpert() {
            const input = document.getElementById('expertInput').value;
            const res = document.getElementById('expertRes');
            if(!input) return;

            res.classList.remove('hidden');
            res.innerHTML = "<i class='fas fa-sync animate-spin ml-2'></i> המומחה מנתח את התקלה...";

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=AIzaSyDD7YAdTePRWYjwBbmy3gLRYd_OLDwpTL8`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: `אתה המומחה הטכני של מרכז שירות ברע"מ. ענה בקצרה ובמקצועיות על שאלת רכב של לקוח (קבוצת VAG בלבד: אאודי, פולקסווגן, סקודה, סיאט). שאלה: ${input}` }] }] })
                });
                const d = await response.json();
                res.innerHTML = "<b>המומחה:</b> " + d.candidates[0].content.parts[0].text;
            } catch (e) {
                res.innerHTML = "שגיאה בחיבור ל-AI. נסה שוב מאוחר יותר.";
            }
        }
    </script>
</body>
</html>
